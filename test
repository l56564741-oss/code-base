private static final ThreadPoolExecutor EXECUTOR = new ThreadPoolExecutor(
    0,                                    // No core threads
    500,                                  // Max 500 threads (safety limit)
    10L, TimeUnit.SECONDS,                // Kill idle threads after 10 seconds
    new SynchronousQueue<>(),
    new ThreadFactory() {
        private final AtomicInteger counter = new AtomicInteger(0);
        public Thread newThread(Runnable r) {
            Thread t = new Thread(r);
            t.setName("http-" + counter.incrementAndGet());
            t.setDaemon(true);              // Important: daemon threads
            return t;
        }
    }
);

private static final HttpClient HTTP_CLIENT = HttpClient.newBuilder()
    .connectTimeout(Duration.ofSeconds(10))
    .executor(EXECUTOR)
    .version(HttpClient.Version.HTTP_2)
    .build();
